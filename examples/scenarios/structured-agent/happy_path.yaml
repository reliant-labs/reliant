# Happy Path: LLM calls response tool successfully
#
# Tests the simplest path through structured-agent:
# 1. LLM is called
# 2. LLM calls the response tool (submit_response by default)
# 3. Response tool executes, extracting structured data
# 4. Loop exits because completed = true
#
# This verifies the response tool mechanism works correctly.

name: happy_path
description: LLM calls response tool on first turn, loop exits with structured output

inputs:
  response_tool_name: "submit_response"

events:
  # LLM calls the response tool directly
  - node: agent_loop.call_llm
    type: llm_response
    text: "I've analyzed your request and here's my response."
    tool_calls:
      - name: submit_response
        input:
          choice: "complete"
          value: "Task completed successfully. The analysis shows positive results."

  # Response tool execution (captures structured data)
  - node: agent_loop.execute_tools
    type: tool_result
    tool: submit_response
    output:
      choice: "complete"
      value: "Task completed successfully. The analysis shows positive results."

expect:
  outcome: completed
  reached:
    - agent_loop
    - agent_loop.call_llm
    - agent_loop.execute_tools
  not_reached:
    # No reminder needed - response tool was called
    - agent_loop.remind_response
    - agent_loop.approval
    - agent_loop.compact
